{
  "lexicon": 1,
  "id": "app.atchess.challenge",
  "defs": {
    "main": {
      "type": "record",
      "description": "A chess game challenge/invitation",
      "key": "tid",
      "record": {
        "type": "object",
        "required": ["createdAt", "challenger", "challenged", "status"],
        "properties": {
          "createdAt": {
            "type": "string",
            "format": "datetime",
            "description": "When the challenge was created"
          },
          "challenger": {
            "type": "string",
            "format": "did",
            "description": "DID of the player issuing the challenge"
          },
          "challenged": {
            "type": "string",
            "format": "did",
            "description": "DID of the player being challenged"
          },
          "status": {
            "type": "string",
            "enum": ["pending", "accepted", "declined", "cancelled"],
            "description": "Challenge status"
          },
          "color": {
            "type": "string",
            "enum": ["white", "black", "random"],
            "default": "random",
            "description": "Color preference for challenger"
          },
          "proposedGameId": {
            "type": "string",
            "description": "Proposed record key for the game that both players should create"
          },
          "timeControl": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",
                "enum": ["correspondence", "rapid", "blitz", "bullet"],
                "default": "correspondence",
                "description": "Type of time control"
              },
              "initial": {
                "type": "integer",
                "default": 600,
                "description": "Initial time in seconds (default 10 minutes)"
              },
              "increment": {
                "type": "integer",
                "default": 0,
                "description": "Increment per move in seconds"
              },
              "daysPerMove": {
                "type": "integer",
                "minimum": 1,
                "maximum": 7,
                "default": 3,
                "description": "Days allowed per move for correspondence games"
              }
            }
          },
          "message": {
            "type": "string",
            "maxLength": 300,
            "description": "Optional message with the challenge"
          },
          "expiresAt": {
            "type": "string",
            "format": "datetime",
            "description": "When the challenge expires"
          },
          "games": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "uri": {
                  "type": "string",
                  "description": "AT Protocol URI of the game record"
                },
                "cid": {
                  "type": "string",
                  "description": "Content identifier of the game record"
                },
                "owner": {
                  "type": "string",
                  "format": "did", 
                  "description": "DID of the player who owns this game record"
                }
              }
            },
            "description": "References to game records created from this challenge"
          }
        }
      }
    }
  }
}